/* checker background pattern */
.checker-background::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image: linear-gradient(#e6e6e690 1px, transparent 1px),
    linear-gradient(90deg, #e6e6e690 1px, transparent 1px);
  background-size: 3.7em 3.7em;
  mask-image: radial-gradient(ellipse at 50% 40%, black 0%, transparent 55%);
  z-index: -1;
  background-position-x: center;
}

/* ---------- checkbox tokens ---------- */
:root {
  --cb-size: 1rem;
  --cb-radius: 0.5rem;                /* slightly softer corners */
  --cb-border: #d4d4d8;               /* neutral border */
  --cb-border-hover: #a1a1aa;
  --cb-ring: rgba(24, 24, 27, 0.25);  /* neutral focus ring */
  --cb-bg: #fff;
  --cb-bg-checked: #25252b;           /* elegant near-black */
  --cb-bg-checked-hover: #262626;
}

/* base */
.file-checkbox,
.header-checkbox {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;

  width: var(--cb-size);
  height: var(--cb-size);
  border-radius: var(--cb-radius);
  border: 1.5px solid var(--cb-border);
  background: var(--cb-bg);
  box-shadow:
    inset 0 1px 0 rgba(0, 0, 0, 0.03), /* subtle depth */
    0 0 0 0 rgba(0, 0, 0, 0);          /* ring placeholder */
  transition: border-color 160ms ease, background-color 160ms ease,
              box-shadow 160ms ease, transform 120ms ease;
  cursor: pointer;
  display: inline-block;
  vertical-align: middle;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 72% 72%;
}

.file-checkbox:hover,
.header-checkbox:hover {
  border-color: var(--cb-border-hover);
}

.file-checkbox:active,
.header-checkbox:active {
  transform: scale(0.96);
}

/* focus ring */
.file-checkbox:focus-visible,
.header-checkbox:focus-visible {
  outline: none;
  box-shadow:
    inset 0 1px 0 rgba(0, 0, 0, 0.03),
    0 0 0 3px var(--cb-ring);
}

/* checked */
.file-checkbox:checked,
.header-checkbox:checked {
  border-color: var(--cb-bg-checked);
  background-color: var(--cb-bg-checked);
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='none' stroke='white' stroke-width='2.2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='4 11 8 15 16 6'/%3e%3c/svg%3e");
}

.file-checkbox:checked:hover,
.header-checkbox:checked:hover {
  background-color: var(--cb-bg-checked-hover);
  border-color: var(--cb-bg-checked-hover);
}

/* indeterminate state for header checkbox only */
.header-checkbox:indeterminate {
  border-color: var(--cb-bg-checked);
  background-color: var(--cb-bg-checked);
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='none' stroke='white' stroke-width='2.2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M4 12h12'/%3e%3c/svg%3e");
}

.header-checkbox:indeterminate:hover {
  background-color: var(--cb-bg-checked-hover);
  border-color: var(--cb-bg-checked-hover);
}

/* disabled */
.file-checkbox:disabled,
.header-checkbox:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* high contrast safety */
@media (forced-colors: active) {
  .file-checkbox,
  .header-checkbox {
    forced-color-adjust: none;
    border-color: ButtonBorder;
    background: Canvas;
  }
  .file-checkbox:checked,
  .header-checkbox:checked {
    background: CanvasText;
    background-image: none;
  }
}

/* hide default summary marker */
summary::-webkit-details-marker {
  display: none;
}

/* animations */
.connection-pulse {
  animation: pulse-glow 2s ease-in-out infinite;
}

@keyframes pulse-glow {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

.connection-line-animate {
  animation: line-draw 2.5s ease-in-out;
}

@keyframes line-draw {
  0% { transform: scaleX(0); }
  100% { transform: scaleX(1); }
}
